<!-- Floating launcher button -->
<button class="lexi-launcher" (click)="toggle()" aria-label="Open chat">
  <jhi-loading-animation [canvasSize]="100"></jhi-loading-animation>
</button>

<!-- Chat window -->
<div class="lexi-window" [class.open]="open()">
  <header class="lexi-header">
    <div class="lexi-title">✦ Chat with Lexi</div>
    <button class="lexi-close" (click)="toggle()" aria-label="Close">✕</button>
  </header>

  <section class="lexi-body" role="log" aria-live="polite">
    <div
      *ngFor="let m of messages(); let i = index"
      class="lexi-msg"
      [class.user]="m.role === 'user'"
    >
      <div class="lexi-bubble">{{ m.text }}</div>
    </div>

    <div *ngIf="sending()" class="lexi-typing">
      <span class="dot"></span><span class="dot"></span
      ><span class="dot"></span>
    </div>
  </section>

  <footer class="lexi-input">
    <textarea
      [placeholder]="sending() ? 'Thinking…' : 'Type a message…'"
      [disabled]="sending()"
      (keydown)="keydown($event)"
      [ngModel]="input()"
      (ngModelChange)="input.set($event)"
    >
    </textarea>

    <button
      class="lexi-send"
      [disabled]="sending()"
      (click)="send()"
      aria-label="Send"
    >
      ➤
    </button>
  </footer>
</div>
